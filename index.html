<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-16">
  <script src="https://kit.fontawesome.com/be027b1dd0.js" crossorigin="anonymous"></script>
  <meta http-equiv="refresh" content="59">
  <title></title>
  <meta name="author" content="">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h1 style="text-align:left;float:left;">  <i class="fas fa-subway"></i>   Wallisellen, Neugut</h1>
  <h2 style="text-align:right;float:right;"></h2>
  <hr style="clear:both;"/>

  <table class="table">
    <thead>
      <tr>
        <th scope="col"></th>
        <th scope="col">Linie</th>
        <th scope="col">Ziel</th>
        <th scope="col">Abfahrt</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  
    <script>
    
      const departureHome = () => {
      const url = "http://transport.opendata.ch/v1/stationboard?station=Wallisellen,Neugut&limit=10"
      const hours = new Date().getHours()
      const minutes = new Date().getMinutes()

      const h2 = document.querySelector("h2");
      h2.insertAdjacentHTML("afterbegin", `${hours}:${minutes}`)

      fetch(url)
        .then(response => response.json())
        .then((data) => {
          console.log(hours)
          console.log(minutes)
          const stationboard = data.stationboard.reverse();
          const tbody = document.querySelector("tbody");

          stationboard.forEach((station) => {
            ziel = station.to
            abfahrt = new Date(station.stop.departure)
            today = new Date()
            zeit = Math.round(Math.abs(today - abfahrt) / 60000)
            if (zeit < 6) {
              row = `<tr><th scope="row"></th><td>Linie 12</td><td>${ziel}</td><td class="time">${zeit} min</td></tr`
              tbody.insertAdjacentHTML("afterbegin", row)
            } else {
              row = `<tr><th scope="row"></th><td>Linie 12</td><td>${ziel}</td><td>${zeit} min</td></tr`
              tbody.insertAdjacentHTML("afterbegin", row)
            }
          });

          const times = document.querySelectorAll(".time");
          times.forEach((time) =>{
            time.classList.add("bold-font");
          });
        });
    };

    departureHome();

    const lager = () => {
          const tbody = document.querySelector("tbody")
          const row = '<tr><th scope="row"></th><td>Linie 12</td><td>Ziel</td><td>Abfahrt in</td></tr>'
          tbody.insertAdjacentHTML("afterbegin", row);
    } 
      
      
    </script>
  
  </body>

</html>
